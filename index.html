<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Trashcore Service</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
<link rel="manifest" href="manifest.json"/>
<meta name="theme-color" content="#1E90FF"/>
<style>
  :root{--card-bg:#1E90FF;--dark-card:#111;}
  *{box-sizing:border-box}
  body{font-family:Arial, sans-serif;margin:0;padding:0;text-align:center;transition:background .4s}
  body.logged-in{background:#000;color:#fff}
  body:not(.logged-in){background:linear-gradient(135deg,#FF4D4D 0%,#B3B3B3 100%);color:#fff}
  .hidden{display:none}
  .form-container,.card-container,.card{background:var(--card-bg);padding:24px;border-radius:12px;margin:12px auto;color:#fff;max-width:420px;transition:background .3s}
  body.logged-in .form-container, body.logged-in .card, body.logged-in .card-container{background:var(--dark-card)}
  input,select,button,textarea{width:100%;padding:10px;margin:8px 0;border-radius:8px;border:0;font-size:14px}
  button{font-weight:700;cursor:pointer}
  .toggle-form{background:none;color:yellow;border:none;text-decoration:underline;cursor:pointer;padding:8px}
  h1{color:#ff4d4d;margin-bottom:14px;text-shadow:2px 2px 6px rgba(0,0,0,.25)}
  .logo{width:92px;height:92px;border-radius:50%;margin-bottom:12px}
  .button{display:flex;justify-content:center;align-items:center;gap:10px;padding:12px;border-radius:10px;color:#fff;text-decoration:none;margin:10px 0;font-weight:700}
  .telegram{background:linear-gradient(90deg,#00BFFF,#1E90FF)}
  .whatsapp{background:linear-gradient(90deg,#32CD32,#00FF7F);color:#000}
  .logout-btn{background:#FF4500;color:#fff;padding:10px;border-radius:10px}
  .card-row{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:18px;margin-top:18px}
  .wave-container{position:fixed;bottom:0;left:0;width:100%;height:160px;pointer-events:none;z-index:0}
  .wave{position:absolute;width:200%;height:200%;border-radius:40%;opacity:.18;animation:waveMove 10s linear infinite;transform-origin:center}
  .wave.wave2{bottom:8px;opacity:.08;animation-duration:14s}
  @keyframes waveMove{0%{transform:translateX(0) rotate(0)}50%{transform:translateX(50%) rotate(3deg)}100%{transform:translateX(0) rotate(0)}}
  .menu{position:fixed;top:18px;right:18px;z-index:1100}
  .menu-btn{background:rgba(255,255,255,.85);border:0;padding:10px 14px;border-radius:50px;cursor:pointer;display:flex;gap:8px;align-items:center}
  .dropdown{position:absolute;top:54px;right:0;background:#000;color:#fff;border-radius:8px;min-width:180px;overflow:hidden;max-height:0;opacity:0;transform:translateY(-8px);transition:all .25s}
  .dropdown.show{max-height:400px;opacity:1;transform:translateY(0)}
  .dropdown a{display:block;padding:10px 12px;color:#fff;text-decoration:none;font-weight:700}
  .dropdown a:hover{background:#222}
  #appDownloadPrompt{display:none;position:fixed;bottom:18px;left:12px;right:12px;background:#1E90FF;color:#fff;padding:12px;border-radius:10px;z-index:1200}
  #appDownloadPrompt button{margin-left:8px;padding:8px 12px;border-radius:8px;border:0}
  .small-note{font-size:12px;color:rgba(255,255,255,.8);margin-top:6px}
  code{word-break:break-all}
  .result-link{display:block;margin-top:8px;text-decoration:none;padding:10px;border-radius:8px}
  @media (max-width:520px){ .form-container,.card{padding:18px} }
</style>
</head>
<body>

<!-- background music (muted by default to avoid autoplay blocks on some browsers) -->
<audio id="bgMusic" src="https://files.catbox.moe/dqlb0t.mp3" loop muted></audio>
<button id="musicBtn" style="position:fixed;bottom:18px;right:18px;padding:10px 14px;border-radius:8px;border:0;background:#32CD32;color:#fff;z-index:1200">üîä Play Music</button>

<!-- waves -->
<div class="wave-container" aria-hidden="true">
  <div class="wave wave1" style="background:radial-gradient(circle at 30% 30%, rgba(255,255,255,0.05), transparent 20%), linear-gradient(90deg,#ffffff22,#00000011)"></div>
  <div class="wave wave2" style="background:radial-gradient(circle at 70% 70%, rgba(255,255,255,0.03), transparent 20%), linear-gradient(90deg,#ffffff11,#00000006)"></div>
</div>

<!-- Sign Up Form -->
<div class="form-container" id="signupForm" aria-live="polite">
  <h1>Sign Up</h1>
  <input id="signupUsername" type="text" placeholder="Username (3-15 chars)" autocomplete="username" />
  <input id="signupEmail" type="email" placeholder="Email" autocomplete="email" />
  <input id="signupPassword" type="password" placeholder="Password (min 6 chars)" autocomplete="new-password" />
  <button id="createAccountBtn" style="background:#32CD32;color:#fff" onclick="signup()">Create Account</button>
  <button class="toggle-form" style="background:#FFA500;color:#fff" onclick="showLoginForm()">Already have an account? Login</button>
  <div class="small-note" style="color:black;background:#fff;padding:6px;border-radius:6px;margin-top:10px;display:inline-block">¬©Ô∏è 2025 Trashcore Devs</div>
</div>

<!-- Login Form -->
<div class="form-container hidden" id="loginForm" aria-live="polite">
  <h1>Login</h1>
  <input id="loginUsername" type="text" placeholder="Username" autocomplete="username" />
  <input id="loginEmail" type="email" placeholder="Email" autocomplete="email" />
  <input id="loginPassword" type="password" placeholder="Password" autocomplete="current-password" />
  <button style="background:#32CD32;color:#fff" onclick="login()">Login</button>
  <button class="toggle-form" style="background:#FFA500;color:#fff" onclick="showSignupForm()">Don't have an account? Sign Up</button>
</div>

<!-- Hamburger Menu -->
<div class="menu hidden" id="menu">
  <button class="menu-btn" id="menuBtn" aria-expanded="false"><i class="fas fa-bars"></i> <span style="font-weight:700;margin-left:6px">Menu</span></button>
  <nav class="dropdown" id="dropdownMenu" aria-hidden="true">
    <a href="https://t.me/trashcoredev" target="_blank" rel="noopener">Chat with Owner</a>
    <a href="https://youtube.com/@giddytennor?si=H-fa3xk3pYlTE0os" target="_blank" rel="noopener">YouTube Channel</a>
    <a href="https://www.instagram.com/putrazyy_xd_?igsh=YzZ0NDRoaXFxM2Zk" target="_blank" rel="noopener">Instagram</a>
    <a href="#" onclick="refreshPage();return false">Refresh Page</a>
    <a href="#" onclick="exitPage();return false">Exit Page</a>
  </nav>
</div>

<!-- Main Content -->
<div class="card-container hidden" id="mainContent" aria-live="polite">
  <h1 class="page-title">TRASHCORE SITE</h1>

  <div class="card-row">

    <!-- Services Card -->
    <section class="card" aria-labelledby="servicesTitle">
      <img src="https://files.catbox.moe/7x996w.jpg" alt="Logo" class="logo" />
      <h2 id="servicesTitle">MY SERVICES</h2>
      <a class="button telegram" href="https://t.me/TrashcoreBot" target="_blank" rel="noopener"><i class="fab fa-telegram-plane"></i> Server 1</a>
      <a class="button telegram" href="http://t.me/Traschoreultra_bot" target="_blank" rel="noopener"><i class="fab fa-telegram-plane"></i> Server 2</a>
      <a class="button telegram" href="https://t.me/theaccidentallygeniuses" target="_blank" rel="noopener"><i class="fab fa-telegram-plane"></i> Join Telegram group</a>
      <a class="button whatsapp" href="https://whatsapp.com/channel/0029VafrbsKG8l5EFBDDCy41" target="_blank" rel="noopener"><i class="fab fa-whatsapp"></i> Join WhatsApp Channel</a>

      <h3 style="margin-top:14px">Social Media Downloads</h3>
      <div style="text-align:left;margin-top:8px">
        <label for="socialPlatform" style="display:block;font-weight:700;margin-bottom:6px">Platform</label>
        <select id="socialPlatform" aria-label="Select social platform">
          <option value="Pinterest">Pinterest</option>
          <option value="TikTok">TikTok</option>
          <option value="Instagram">Instagram</option>
          <option value="Facebook">Facebook</option>
        </select>
        <input id="socialLink" type="text" placeholder="Paste video/photo link here" aria-label="Paste social media link" />
        <button onclick="downloadSocialMedia()" style="background:#32CD32;color:#fff">Get Download Link</button>
        <div id="socialResults" style="margin-top:10px"></div>
      </div>

      <button class="logout-btn" onclick="logout()" aria-hidden="false">Logout</button>
    </section>

    <!-- Music Search Card -->
    <section class="card" id="musicCard" aria-labelledby="musicTitle">
      <h2 id="musicTitle">Music Search & Download</h2>
      <input id="songQuery" type="text" placeholder="Enter song name or YouTube link" />
      <button onclick="searchSong()" style="background:#1E90FF;color:#fff">Search</button>
      <div id="songResults" style="margin-top:10px;text-align:left"></div>
    </section>

    <!-- Mediafire Download Card -->
    <section class="card" id="mediafireCard" aria-labelledby="mediafireTitle">
      <h2 id="mediafireTitle">Mediafire Download</h2>
      <input id="fileLink" type="text" placeholder="Paste Mediafire link here" />
      <button onclick="downloadFile()" style="background:#FF69B4;color:#fff">Get Download Link</button>
      <div id="downloadResult" style="margin-top:10px"></div>
    </section>

  </div>
</div>

<!-- App Install Prompt -->
<div id="appDownloadPrompt" role="dialog" aria-live="polite" aria-hidden="true">
  <span>Install Trashcore on your device for a better experience!</span>
  <button id="downloadAppBtn">Install</button>
  <button id="dismissAppBtn">Dismiss</button>
</div>

<!-- Footer copyright -->
<div style="padding:12px;text-align:center;color:rgba(0,0,0,0.6);margin-top:8px">¬©Ô∏è 2025 Trashcore Devs</div>

<script>
/* -------------------------
   Local user storage + auth
   ------------------------- */
let users = JSON.parse(localStorage.getItem('users') || '[]');

function isValidUsername(name){ return /^[a-zA-Z0-9_]{3,15}$/.test(name); }
function isValidPassword(pw){ return typeof pw === 'string' && pw.length >= 6; }

function showLoginForm(){
  document.getElementById('signupForm').classList.add('hidden');
  document.getElementById('loginForm').classList.remove('hidden');
}
function showSignupForm(){
  document.getElementById('loginForm').classList.add('hidden');
  document.getElementById('signupForm').classList.remove('hidden');
}

function signup(){
  const username = document.getElementById('signupUsername').value.trim();
  const email = document.getElementById('signupEmail').value.trim();
  const password = document.getElementById('signupPassword').value;
  if(!username || !email || !password){ alert('Fill all fields'); return; }
  if(!isValidUsername(username)){ alert('Invalid username'); return; }
  if(!isValidPassword(password)){ alert('Password must be at least 6 characters'); return; }
  if(users.some(u=>u.username===username)){ alert('Username exists'); return; }
  users.push({username,email,password});
  localStorage.setItem('users', JSON.stringify(users));
  alert('Account created! Please login.');
  showLoginForm();
}

function login(){
  const username = document.getElementById('loginUsername').value.trim();
  const email = document.getElementById('loginEmail').value.trim();
  const password = document.getElementById('loginPassword').value;
  const user = users.find(u => u.username===username && u.email===email && u.password===password);
  if(user){
    localStorage.setItem('loggedInUser', username);
    enterApp(username);
  } else {
    alert('Invalid credentials.');
  }
}

function logout(){
  localStorage.removeItem('loggedInUser');
  document.body.classList.remove('logged-in');
  document.getElementById('mainContent').classList.add('hidden');
  document.getElementById('menu').classList.add('hidden');
  showSignupForm();
}

function enterApp(username){
  document.body.classList.add('logged-in');
  document.getElementById('signupForm').classList.add('hidden');
  document.getElementById('loginForm').classList.add('hidden');
  document.getElementById('mainContent').classList.remove('hidden');
  document.getElementById('menu').classList.remove('hidden');
  // try to play music (will be muted/blocked on some browsers)
  const music = document.getElementById('bgMusic');
  if(music){ music.play().catch(()=>{/* autoplay blocked */}); }
}

/* If already logged in on page load, enter app */
if(localStorage.getItem('loggedInUser')){
  enterApp(localStorage.getItem('loggedInUser'));
}

/* -------------------------
   Menu toggle
   ------------------------- */
const menuBtn = document.getElementById('menuBtn');
const dropdown = document.getElementById('dropdownMenu');
if(menuBtn){
  menuBtn.addEventListener('click', ()=>{
    dropdown.classList.toggle('show');
    const expanded = menuBtn.getAttribute('aria-expanded') === 'true';
    menuBtn.setAttribute('aria-expanded', (!expanded).toString());
    dropdown.setAttribute('aria-hidden', expanded ? 'true' : 'false');
  });
}
window.addEventListener('click', (e)=>{
  if(!e.target.closest('.menu-btn')){
    dropdown.classList.remove('show');
    menuBtn.setAttribute('aria-expanded','false');
    dropdown.setAttribute('aria-hidden','true');
  }
});

/* -------------------------
   Music toggle
   ------------------------- */
const music = document.getElementById('bgMusic');
const musicBtn = document.getElementById('musicBtn');
musicBtn.addEventListener('click', ()=>{
  if(!music) return;
  if(music.paused || music.muted){
    music.muted = false;
    music.play().catch(()=>{/* blocked */});
    musicBtn.textContent = 'üîä Music Playing';
  } else {
    music.pause();
    musicBtn.textContent = 'üîá Music Paused';
  }
});

/* -------------------------
   Music search (iTunes preview)
   ------------------------- */
async function searchSong(){
  const q = document.getElementById('songQuery').value.trim();
  const out = document.getElementById('songResults');
  if(!q){ alert('Enter a song name'); return; }
  out.textContent = 'Searching...';
  try{
    const res = await fetch(`https://itunes.apple.com/search?term=${encodeURIComponent(q)}&limit=12`);
    const data = await res.json();
    out.innerHTML = '';
    if(!data.results || data.results.length === 0){
      out.textContent = 'No results found.';
      return;
    }
    const ul = document.createElement('ul');
    data.results.forEach(item=>{
      const li = document.createElement('li');
      const preview = item.previewUrl ? `<a href="${item.previewUrl}" target="_blank" rel="noopener" download>Preview/Download</a>` : '';
      li.innerHTML = `<strong>${escapeHtml(item.trackName||item.collectionName||'Unknown')}</strong> ‚Äî ${escapeHtml(item.artistName||'Unknown')} ${preview}`;
      ul.appendChild(li);
    });
    out.appendChild(ul);
  } catch(err){
    console.error(err);
    out.textContent = 'Error fetching songs.';
  }
}

/* -------------------------
   Mediafire quick link
   ------------------------- */
function downloadFile(){
  const link = document.getElementById('fileLink').value.trim();
  const out = document.getElementById('downloadResult');
  if(!link){ alert('Enter Mediafire link'); return; }
  // We simply provide the link as clickable download - replace with backend if needed
  out.innerHTML = `<a class="result-link" href="${escapeAttr(link)}" target="_blank" rel="noopener" style="background:#FF69B4;color:#fff">Click here to download to your phone</a>`;
}

/* -------------------------
   Social media downloads UI
   ------------------------- */
function downloadSocialMedia(){
  const platform = document.getElementById('socialPlatform').value;
  const link = document.getElementById('socialLink').value.trim();
  const out = document.getElementById('socialResults');
  if(!link){ alert('Please paste a link'); return; }
  out.innerHTML = '<p>Processing...</p>';
  // In a production app you'd call a server-side API that returns a downloadable file URL.
  // For this client demo we simply present the provided link as the "downloadable" URL.
  try{
    const downloadURL = link;
    const fileName = `${platform}_download`;
    out.innerHTML = `
      <p style="font-weight:700">${escapeHtml(platform)} Download Ready:</p>
      <a class="result-link" href="${escapeAttr(downloadURL)}" download="${escapeAttr(fileName)}" style="background:#32CD32;color:#fff">Click here to download to your phone</a>
      <div style="margin-top:8px;color:rgba(255,255,255,.9)">If the download doesn't start automatically, long-press the button and choose "Save link" on mobile.</div>
    `;
  } catch(err){
    console.error(err);
    out.innerHTML = '<p style="color:#ffdddd">Error preparing download.</p>';
  }
}

/* -------------------------
   App install prompt (PWA)
   ------------------------- */
let deferredPrompt = null;
const appPrompt = document.getElementById('appDownloadPrompt');
window.addEventListener('beforeinstallprompt', (e)=>{
  e.preventDefault();
  deferredPrompt = e;
  if(!localStorage.getItem('appPromptDismissed')){
    appPrompt.style.display = 'block';
    appPrompt.setAttribute('aria-hidden','false');
  }
});
document.getElementById('downloadAppBtn').addEventListener('click', async ()=>{
  appPrompt.style.display = 'none';
  if(deferredPrompt){
    deferredPrompt.prompt();
    const choice = await deferredPrompt.userChoice;
    console.log('PWA install choice', choice);
    deferredPrompt = null;
  }
});
document.getElementById('dismissAppBtn').addEventListener('click', ()=>{
  appPrompt.style.display = 'none';
  localStorage.setItem('appPromptDismissed','true');
});

/* -------------------------
   Utilities
   ------------------------- */
function escapeHtml(s){ if(!s) return ''; return String(s).replace(/[&<>"']/g, c=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;' })[c]); }
function escapeAttr(s){ return escapeHtml(s).replace(/"/g,'&quot;'); }
function refreshPage(){ location.reload(); }
function exitPage(){ if(confirm('Are you sure you want to exit?')){ window.open('','_self'); window.close(); } }

/* -------------------------
   Register service worker (if you have one)
   ------------------------- */
if('serviceWorker' in navigator){
  navigator.serviceWorker.register('sw.js').then(()=>console.log('Service Worker registered')).catch(()=>{/* sw failed */});
}
</script>
</body>
</html>
